# QA Environment Configuration
# Server
server.port=8222

# Application
spring.application.name=service-gateway

# Gateway Discovery
spring.cloud.config.enabled=false



# Gateway Routes - QA Environment
# Auth Service
spring.cloud.gateway.routes[0].id=auth-service
spring.cloud.gateway.routes[0].uri=http://auth-service:8005
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/auth/**
spring.cloud.gateway.routes[0].filters[0]=StripPrefix=2

# Certificat Service
spring.cloud.gateway.routes[1].id=certificat-service
spring.cloud.gateway.routes[1].uri=http://certificat-service:8086
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/certificat/**
spring.cloud.gateway.routes[1].filters[0]=StripPrefix=2

# Evaluation Service
spring.cloud.gateway.routes[2].id=evaluation-service
spring.cloud.gateway.routes[2].uri=http://evaluation-service:8087
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/evaluation/**
spring.cloud.gateway.routes[2].filters[0]=StripPrefix=2

# Formation Service
spring.cloud.gateway.routes[3].id=formation-service
spring.cloud.gateway.routes[3].uri=http://formation-service:8088
spring.cloud.gateway.routes[3].predicates[0]=Path=/api/formation/**
spring.cloud.gateway.routes[3].filters[0]=StripPrefix=2

# AI Recommendation Service
spring.cloud.gateway.routes[4].id=ai-reco-service
spring.cloud.gateway.routes[4].uri=http://ai-reco-service:8000
spring.cloud.gateway.routes[4].predicates[0]=Path=/api/ai/**
spring.cloud.gateway.routes[4].filters[0]=StripPrefix=2

# Besoins Formation Service
spring.cloud.gateway.routes[5].id=besoinsformation-service
spring.cloud.gateway.routes[5].uri=http://besoinsformation-service:8004
spring.cloud.gateway.routes[5].predicates[0]=Path=/api/besoinsformation/**
spring.cloud.gateway.routes[5].filters[0]=StripPrefix=2

# Competence Service
spring.cloud.gateway.routes[6].id=competence-service
spring.cloud.gateway.routes[6].uri=http://competence-service:8005
spring.cloud.gateway.routes[6].predicates[0]=Path=/api/competence/**
spring.cloud.gateway.routes[6].filters[0]=StripPrefix=2

########################################

# Uncomment if Eureka is used
# eureka.client.service-url.defaultZone=http://eureka-server-qa:8761/eureka
# eureka.instance.prefer-ip-address=true
# eureka.instance.hostname=gateway-qa

########################################
# CORS Configuration (QA)
########################################
spring.cloud.gateway.globalcors.cors-configurations.[/**].allowed-origins[0]=http://qa-frontend:3000
spring.cloud.gateway.globalcors.cors-configurations.[/**].allowed-origins[1]=http://esprit-d2f.esprit.tn/*
spring.cloud.gateway.globalcors.cors-configurations.[/**].allowed-methods=GET,POST,PUT,DELETE,OPTIONS,PATCH
spring.cloud.gateway.globalcors.cors-configurations.[/**].allowed-headers=*
spring.cloud.gateway.globalcors.cors-configurations.[/**].allow-credentials=true
spring.cloud.gateway.globalcors.cors-configurations.[/**].max-age=3600

########################################
# Spring Boot Core
########################################
spring.main.allow-bean-definition-overriding=true

########################################
# Logging Configuration
########################################
logging.level.org.springframework.cloud.gateway=DEBUG
logging.level.com.example.servicegateway=DEBUG
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

########################################
# Health & Monitoring
########################################
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when-authorized